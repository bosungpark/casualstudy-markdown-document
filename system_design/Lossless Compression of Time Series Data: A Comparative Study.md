# Lossless Compression of Time Series Data: A Comparative Study

## 출처
- **링크**: https://arxiv.org/abs/2510.07015
- **저자**: Jonas G. Matt, Pengcheng Huang, Balz Maag
- **발표**: 2025년 10월 (arXiv)
- **비고**: 현재까지 가장 대규모의 무손실 압축 비교 연구

---

## AI 요약

### 논문 개요

이 논문은 시계열 데이터에 대한 무손실 압축 알고리즘들을 체계적으로 비교 분석한다. gzip(DEFLATE), Zstd, Brotli, LZ4 등 범용 알고리즘부터 시계열 특화 알고리즘(Sprintz, Pcodec)까지 포괄하며, **2단계 압축 프레임워크**(데이터 변환 + 엔트로피 인코딩)를 제시한다.

### 핵심 구조: 2단계 압축 프레임워크
```
┌───────────────────────────────────────────────────────────────┐
│              무손실 압축의 2단계 프레임워크                      │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  [Stage 1] Data Transformation (전처리)                       │
│  ├─ Delta Encoding: x[i] → x[i] - x[i-1]                     │
│  ├─ Double Delta: 2차 차분 (가속도 데이터용)                    │
│  ├─ XOR Encoding: 부동소수점 데이터용                          │
│  └─ 목적: 데이터의 엔트로피 감소                                │
│                                                               │
│  [Stage 2] Entropy Encoding (압축)                            │
│  ├─ Huffman Coding: 빈도 기반 가변 길이 코딩 (gzip)            │
│  ├─ ANS/FSE: Asymmetric Numeral Systems (Zstd)               │
│  └─ Arithmetic Coding: 최적에 가까운 엔트로피 코딩              │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

### 1. gzip/DEFLATE 알고리즘 분석

#### 1.1 핵심 구조
```
┌───────────────────────────────────────────────────────────────┐
│                    DEFLATE = LZ77 + Huffman                   │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  [LZ77 단계] Dictionary Coding                                │
│  ├─ 슬라이딩 윈도우: 32KB (고정)                                │
│  ├─ 최소 매치 길이: 3 bytes                                    │
│  ├─ 최대 매치 길이: 258 bytes                                  │
│  ├─ 최대 거리: 32,768 bytes                                   │
│  └─ 동작: 반복 문자열 → <거리, 길이> 쌍으로 대체                 │
│                                                               │
│  예시:                                                        │
│  입력: "abcdeabcdf"                                           │
│  출력: "abcde<5,4>f"                                          │
│        ↑ "5칸 뒤에서 4글자 복사"                               │
│                                                               │
│  [Huffman 단계] Entropy Coding                                │
│  ├─ 빈도 높은 심볼 → 짧은 비트                                  │
│  ├─ 빈도 낮은 심볼 → 긴 비트                                   │
│  └─ Dynamic Huffman: 블록마다 최적 트리 생성                    │
│                                                               │
│  예시:                                                        │
│  'e' (빈도 높음) → 10      (2비트)                            │
│  'z' (빈도 낮음) → 110010  (6비트)                            │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

#### 1.2 gzip 압축 레벨 특성

| 레벨 | 동작 | 압축률 | 속도 | 권장 |
|------|------|--------|------|------|
| **1** | 빠른 압축 | 기준 | ~120 MB/s | 실시간 처리 |
| **6** | 기본값 | +5-8% | ~80 MB/s | **일반 용도** |
| **9** | 최대 압축 | +1-2% (vs 6) | ~30 MB/s | 비권장 |

**핵심 인사이트**: 레벨 6 이상에서는 시간 대비 압축률 향상이 미미함

### 2. 알고리즘 비교 벤치마크

#### 2.1 압축률 vs 속도 Trade-off
```
┌───────────────────────────────────────────────────────────────┐
│              압축 알고리즘 포지셔닝 맵                          │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  압축률 (높음)                                                 │
│     ↑                                                         │
│     │  ★ LZMA/xz (4.0x)     ← 최고 압축률, 매우 느림           │
│     │  ★ bzip2 (3.5x)                                        │
│     │  ★ Brotli (3.3x)      ← 웹 최적화                       │
│     │  ★ Zstd (3.2x)        ← gzip 대체 권장                  │
│     │  ★ gzip (3.1x)        ← 범용, 레거시 호환                │
│     │                                                         │
│     │                                                         │
│     │                         ★ LZ4 (1.1x)   ← 실시간용       │
│     │                         ★ Snappy (1.1x)                │
│     └──────────────────────────────────────────→ 속도 (빠름)  │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

#### 2.2 상세 벤치마크 (Silesia Corpus 기준)

| 알고리즘 | 압축률 | 압축 속도 | 해제 속도 | 메모리 | 특징 |
|---------|--------|----------|----------|--------|------|
| **gzip** | 3.1x | ~80 MB/s | ~250 MB/s | 낮음 | 범용, 1992년 |
| **Zstd** | 3.2x | ~400 MB/s | ~800 MB/s | 중간 | Facebook, 2015년 |
| **Brotli** | 3.3x | ~30 MB/s | ~400 MB/s | 중간 | Google, 웹 최적화 |
| **LZ4** | 1.1x | ~800 MB/s | ~4 GB/s | 낮음 | 실시간용 |
| **Snappy** | 1.1x | ~500 MB/s | ~1.5 GB/s | 낮음 | Google |
| **bzip2** | 3.5x | ~15 MB/s | ~80 MB/s | 높음 | BWT 기반 |
| **LZMA/xz** | 4.0x | ~5 MB/s | ~100 MB/s | 높음 | 아카이브용 |

### 3. gzip의 기술적 한계
```
┌───────────────────────────────────────────────────────────────┐
│                    gzip/DEFLATE의 한계점                       │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  [윈도우 크기 제한]                                            │
│  ├─ 32KB 고정 → 먼 거리의 반복 패턴 감지 불가                   │
│  ├─ Zstd: 최대 128MB 윈도우 지원                               │
│  └─ 영향: 대용량 파일에서 압축률 손해                           │
│                                                               │
│  [레벨 조절 범위]                                              │
│  ├─ 1-9 (9단계) → 세밀한 튜닝 불가                             │
│  ├─ Zstd: 1-22 (22단계)                                       │
│  └─ 레벨 6 이상에서 수확체감 심함                               │
│                                                               │
│  [병렬 처리]                                                   │
│  ├─ 단일 스레드만 지원                                         │
│  ├─ pigz (병렬 gzip) 별도 사용 필요                            │
│  └─ Zstd: 네이티브 멀티스레드 지원                              │
│                                                               │
│  [Huffman 코딩 한계]                                          │
│  ├─ 심볼당 최소 1비트 → 엔트로피 < 1일 때 비효율                │
│  └─ ANS(Zstd): 분수 비트 지원으로 더 효율적                     │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

### 4. gzip vs Zstd 심층 비교

| 측면 | gzip | Zstd | 승자 |
|------|------|------|------|
| 압축률 | 3.0-3.5x | 3.0-3.5x | 동등 |
| 압축 속도 | 50-100 MB/s | 200-500 MB/s | **Zstd** (3-5배) |
| 해제 속도 | 200-300 MB/s | 500-1000 MB/s | **Zstd** (2-3배) |
| 레벨 범위 | 1-9 | 1-22 | **Zstd** |
| 윈도우 크기 | 32KB | 최대 128MB | **Zstd** |
| 호환성 | 모든 시스템 | 대부분 시스템 | gzip |
| 출시 | 1992년 | 2015년 | - |

### 5. 데이터 유형별 압축 특성

#### 5.1 gzip이 효과적인 경우
```
[잘 압축되는 데이터]
├─ 텍스트 파일 (HTML, JSON, XML, 로그)
├─ 소스 코드
├─ 반복 패턴이 많은 데이터
└─ 32KB 윈도우 내 중복이 발생하는 데이터

예: 로그 파일 → 압축률 5-10x
```

#### 5.2 gzip이 비효율적인 경우
```
[잘 안 되는 데이터]
├─ 이미 압축된 데이터 (JPEG, MP3, ZIP)
├─ 랜덤/암호화된 데이터
├─ 32KB보다 먼 거리의 반복 패턴
└─ 고엔트로피 바이너리 데이터

예: JPEG 이미지 → 압축률 ~1.0x (거의 효과 없음)
```

### 6. 시계열 데이터 최적화 전략
```
┌───────────────────────────────────────────────────────────────┐
│              시계열 데이터 압축 최적화 전략                      │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  [문제] 시계열 원본 데이터는 gzip으로 압축 효율 낮음             │
│                                                               │
│  [해결] Delta Encoding 전처리                                  │
│                                                               │
│  원본: [100, 101, 103, 102, 105, 104, ...]                    │
│        ↓ Delta Encoding                                       │
│  변환: [100, 1, 2, -1, 3, -1, ...]                            │
│        ↓ gzip                                                 │
│  압축: 작은 값들의 반복 → 높은 압축률                           │
│                                                               │
│  [효과]                                                       │
│  ├─ 압축률 20-40% 추가 향상                                   │
│  ├─ 센서 데이터, 주가 데이터에서 특히 효과적                    │
│  └─ 논문 결과: Delta + gzip이 gzip 단독 대비 1.5-2x 향상       │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

### 7. 실무 선택 가이드
```
┌───────────────────────────────────────────────────────────────┐
│                    Use Case별 알고리즘 선택                    │
├───────────────────────────────────────────────────────────────┤
│                                                               │
│  [웹 콘텐츠]                                                   │
│  ├─ 정적 자산 (CSS, JS): Brotli (사전 압축)                   │
│  └─ 동적 응답: gzip 또는 Zstd                                  │
│                                                               │
│  [로그/백업]                                                   │
│  ├─ 실시간 로그: LZ4 (저지연)                                  │
│  ├─ 일일 백업: Zstd level 3 (균형)                            │
│  └─ 장기 아카이브: xz (최대 압축)                              │
│                                                               │
│  [데이터베이스]                                                │
│  ├─ 핫 데이터: LZ4 (빠른 접근)                                │
│  └─ 콜드 데이터: Zstd (공간 절약)                              │
│                                                               │
│  [레거시 시스템]                                               │
│  └─ 호환성 필수: gzip (유일한 선택)                            │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

### 8. gzip 최적 사용법
```bash
# 일반 용도 (기본값 권장)
gzip file.txt                    # level 6

# 속도 우선 (실시간 처리)
gzip -1 file.txt                 # 빠름, 약간 낮은 압축률

# 압축률 우선 (비권장 - 시간 대비 효과 미미)
gzip -6 file.txt                 # level 6이면 충분

# 시계열 데이터 최적화
# 1. Delta encoding 전처리
python -c "import pandas as pd; df['delta'] = df['value'].diff()"
# 2. 그 후 gzip 적용
gzip timeseries_delta.csv
```

---

## 내가 얻은 인사이트
